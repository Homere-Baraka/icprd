// ============================================
// DONNÉES DE TRADUCTION CORRIGÉES
// ============================================

const translations = {
  en: {
    // Header
    "nav.about": "About Us",
    "nav.what-we-do": "What we do",
    "nav.insights": "Insights",
    "nav.team": "Team",
    "nav.contact": "Contact",
    "header.donate": "Donate Now",
    "nav.environment": "Environment",

    // Hero section
    "hero.badge": "Since 2004 • DRC focus",
    "hero.title": "Building Sustainable Peace & Stability",
    "hero.subtitle":
      "The Christian Initiative for Peace, Reconciliation and Development (ICPRD) works to empower local communities and foster regional harmony through dialogue and sustainable development.",
    "hero.button1": "Get Involved",
    "hero.button2": "Our Strategic Plan",

    // Stats section
    "stats.combatants": "Disarmed Combatants",
    "stats.experience": "Years of Experience",
    "stats.communities": "Communities Reached",
    "stats.partners": "International Partners",

    // Pillars section
    "pillars.subtitle": "Our Intervention Areas",
    "pillars.title": "Driving Change Across Three Core Pillars",
    "pillars.description":
      "Our holistic approach ensures that peace is not just the absence of conflict, but the presence of justice and opportunity.",

    "pillar1.title": "Peace Consolidation",
    "pillar1.desc":
      "A key player in Disarmament, Demobilization and Reintegration (DDR) in South Kivu. We facilitate the repatriation of armed groups and the socio-professional reintegration of combatants.",
    "pillar1.learn": "Learn More",

    "pillar2.title": "Humanitarian Emergency",
    "pillar2.desc":
      "We intervene in health and nutrition when needed during our activities, with the support of our partners.",
    "pillar2.learn": "Learn More",

    "pillar3.title": "Sustainable Development",
    "pillar3.desc":
      "We strengthen community resilience through vocational training, empowerment and advocacy for human rights and local development.",
    "pillar3.learn": "Learn More",

    // Mission section
    "mission.title": "Our Mission: To Heal through ",
    "mission.title_highlight": "Action",
    "mission.desc":
      "The Christian Initiative for Peace, Reconciliation and Development (ICPRD) was born from the urgent need to break systemic cycles of conflict in eastern DRC, to help victimized populations.",
    "mission.point1.title": "Field Action and Mediation",
    "mission.point1.desc":
      "Our approach is based on direct engagement, awareness-raising of conflict parties and mediation to facilitate voluntary disarmament and repatriations.",
    "mission.point2.title": "Community Development",
    "mission.point2.desc":
      "We believe that lasting peace comes through development. We build training centers and support community autonomy for a stable future.",
    "mission.experience": "Years of Field Commitment",

    //environment section
    "environment.badge": "Our Commitment",
    "environment.title": "Environmental Rehabilitation",
    "environment.subtitle":
      "ICPRD intervenes in environmental rehabilitation and advocacy to lead environmental destroyers to rehabilitate it.",
    "environment.action1.title": "Identification of Destroyed Sites",
    "environment.action1.desc":
      "Identification of exploited, destroyed and abandoned mining sites by companies in Kitutu, Mwenga territory, South Kivu.",
    "environment.action2.title": "Radio Awareness",
    "environment.action2.slogan": "The ICPRD team during the identification of mining sites exploited, destroyed and abandoned by Chinese companies in Kitutu",
    "environment.action2.desc":
      "Awareness programs on the proper exploitation of natural resources for the development of Mwenga territory at GL Tv radio studio.",
    "environment.action3.title": "Victim Counseling",
    "environment.action3.desc":
      "Counseling for victims of mining exploitation in Kitutu, Banampute Groupement.",
    "environment.gallery": "Field Actions",
    "environment.gallery.action1": "Identification of mining sites",
    "environment.gallery.action2": "GL TV Radio Broadcast - Mwenga",
    "environment.gallery.action3": "Counseling in Kitutu, Banampute.",

    // Achievements section
    "achievements.title": "Our Achievements",
    "achievements.subtitle":
      "An overview of our lasting impact across South Kivu and North Kivu over the years.",

    "achievement1.title": "1,000+ Former Combatants Reintegrated",
    "achievement1.category": "Peace & Stability",
    "achievement1.status": "Ongoing Project",
    "achievement1.desc":
      "Through psychological support and vocational training, we successfully reintegrate former combatants, including former child soldiers, into their families and communities.",
    "achievement1.report": "Full Report →",

    "achievement2.title": "Voluntary Repatriation of Armed Groups",
    "achievement2.category": "Disarmament",
    "achievement2.status": "2013-2014",
    "achievement2.desc":
      "ICPRD was a key facilitator in awareness and voluntary disarmament operations of armed groups, including FDLR, directly contributing to reducing tensions and violence.",
    "achievement2.report": "Full Report →",

    "achievement3.title": "Kitamba Reintegration Center",
    "achievement3.category": "Development",
    "achievement3.status": "Launched in 2023",
    "achievement3.desc":
      "We built and equipped a training center in Kitamba (Mwenga), offering skills and a future to demobilized individuals. 'PPR is a lung for development,' attests Mwami Kalenga Riziki Lwango.",
    "achievement3.report": "Full Report →",

    // Team section
    "team.title": "Our Leadership Team",
    "team.subtitle":
      "Guided by committed experts, local activists and dedicated peacemakers.",
    "team.position1": "Project Advisor",
    "team.position2": "Executive Secretary",
    "team.position3": "Financial Administrator ICPRD",
    "team.position4": "Humanitarian Coordinator",

    // CTA section
    "cta.title": "Support Peace Today",
    "cta.desc":
      "Your contribution directly funds our community mediation programs, voluntary disarmament and development projects in conflict-affected areas.",
    "cta.button1": "Make a Donation",
    "cta.button2": "Become a Partner",

    // Blog section
    "blog.title": "Latest Reports & Testimonials",
    "blog.subtitle":
      "Detailed analysis and stories from our field operations across DRC.",
    "blog.viewall": "View all articles",

    "blog1.category": "Peace",
    "blog1.title": "Community education on BDH",
    "blog1.desc":
      "Review of our awareness missions in Kigogo, Burhinyi and Minova that led to the repatriation of hundreds of combatants.",
    "blog1.author": "ICPRD Team",
    "blog1.date": "2 days ago",

    "blog2.category": "Training",
    "blog2.title": "Kitamba: A Center for the Future",
    "blog2.desc":
      "How our socio-professional reintegration center trains former combatants in carpentry, sewing and other trades for successful reintegration.",
    "blog2.author": "Testimony",
    "blog2.date": "5 days ago",

    "blog3.category": "Human Rights",
    "blog3.title": "Training Human Rights Defenders",
    "blog3.desc":
      "Report on our workshop in Bukavu on data collection to document incidents in the mining value chain.",
    "blog3.author": "UN Expert",
    "blog3.date": "1 week ago",

    // Contact section
    "contact.title": "Let's Build Peace Together",
    "contact.subtitle":
      "Whether you're looking to partner, volunteer, or support our programs, we'd love to hear from you.",
    "contact.email": "Email Us",
    "contact.email_value": "contact@icprd.com",
    "contact.location": "Visit Us",
    "contact.location_value": "Av Vamaro, No 15, Com d'Ibanda Ville de Bukavu RDC",

    "form.name": "Name",
    "form.name_placeholder": "Full name",
    "form.email": "Email",
    "form.email_placeholder": "Email address",
    "form.subject": "Subject",
    "form.subject_placeholder": "Your message subject",
    "form.message": "Message",
    "form.message_placeholder": "How can we help you?",
    "form.button": "Send Message",

    // Footer
    "footer.desc":
      "Dedicated to fostering harmony and sustainable development across the Democratic Republic of Congo since 2004.",
    "footer.org": "Organization",
    "footer.org.about": "About",
    "footer.org.plan": "Strategic Plan",
    "footer.org.reports": "Annual Reports",
    "footer.org.join": "Join Us",

    "footer.legal": "Legal & Privacy",
    "footer.legal.privacy": "Privacy Policy",
    "footer.legal.charter": "Donor Charter",
    "footer.legal.governance": "Governance",
    "footer.legal.transparency": "Transparency",

    "footer.newsletter": "Newsletter",
    "footer.newsletter.desc":
      "Receive field updates and our reports directly in your inbox.",
    "footer.newsletter.placeholder": "Email address",
    "footer.newsletter.button": "Subscribe",

    "footer.copyright":
      "© 2024 Christian Initiative for Peace, Reconciliation and Development.",
    "footer.tagline1": "Peace is Possible",
    "footer.tagline2": "DRC Strong",
  },

  fr: {
    // Header
    "nav.about": "À propos",
    "nav.what-we-do": "Domaines d'action",
    "nav.insights": "Actualités",
    "nav.team": "Équipe",
    "nav.contact": "Contact",
    "header.donate": "Faire un don",
    "nav.environment": "Environnement",

    // Hero section
    "hero.badge": "Depuis 2004 • Focus RDC",
    "hero.title": "Construction d'une Paix et d'une Stabilité Durables",
    "hero.subtitle":
      "L'Initiative Chrétienne pour la Paix, la Réconciliation et le Développement (ICPRD) œuvre pour autonomiser les communautés locales et favoriser l'harmonie régionale par le dialogue et le développement durable.",
    "hero.button1": "S'impliquer",
    "hero.button2": "Notre Plan Stratégique",

    // Stats section
    "stats.combatants": "Combattants Désarmés",
    "stats.experience": "Années d'Expérience",
    "stats.communities": "Communautés Touchées",
    "stats.partners": "Partenaires Internationaux",

    // Pillars section
    "pillars.subtitle": "Domaines d'Intervention",
    "pillars.title":
      "Agir pour le Changement à Travers Nos Trois Domaines Clés",
    "pillars.description":
      "Notre approche holistique garantit que la paix n'est pas seulement l'absence de conflit, mais la présence de justice et d'opportunités.",

    "pillar1.title": "Consolidation de la Paix",
    "pillar1.desc":
      "Acteur majeur dans le Désarmement, Démobilisation et Réintégration (DDR) au Sud-Kivu. Nous facilitons le rapatriement des groupes armés et la réintégration socio-professionnelle des combattants.",
    "pillar1.learn": "En savoir plus",

    "pillar2.title": "Urgence Humanitaire",
    "pillar2.desc":
      "Nous intervenons dans les domaines de la santé et de la nutrition lorsque le besoin se fait sentir pendant nos activités, avec le soutien de nos partenaires.",
    "pillar2.learn": "En savoir plus",

    "pillar3.title": "Développement Durable",
    "pillar3.desc":
      "Nous renforçons la résilience des communautés par la formation professionnelle, l'autonomisation et le plaidoyer pour les droits humains et le développement local.",
    "pillar3.learn": "En savoir plus",

    // Mission section
    "mission.title": "Notre Mission : Guérir par l'",
    "mission.title_highlight": "Action",
    "mission.desc":
      "L'Initiative Chrétienne pour la Paix, la Réconciliation et le Développement (ICPRD) est née de la nécessité urgente de rompre les cycles systémiques de conflit dans l'Est de la RDC, pour porter secours aux populations victimes.",
    "mission.point1.title": "Action de Terrain et Médiation",
    "mission.point1.desc":
      "Notre approche est fondée sur un engagement direct, la sensibilisation des parties aux conflits et la médiation pour faciliter le désarmement volontaire et les rapatriements.",
    "mission.point2.title": "Développement Communautaire",
    "mission.point2.desc":
      "Nous croyons que la paix durable passe par le développement. Nous construisons des centres de formation et soutenons l'autonomie des communautés pour un avenir stable.",
    "mission.experience": "Années d'Engagement sur le Terrain",

    //environment section
    "environment.badge": "Notre Engagement",
    "environment.title": "Réhabilitation Environnementale",
    "environment.subtitle":
      "L'ICPRD intervient dans la réhabilitation de l'environnement ainsi que le plaidoyer pour amener les destructeurs de l'environnement à le réhabiliter.",
    "environment.action1.title": "Identification des Sites Détruits",
    "environment.action1.desc":
      "Identification des sites miniers exploités, détruits et abandonnés par les entreprises à Kitutu dans le territoire de Mwenga au Sud-Kivu.",
    "environment.action2.title": "Sensibilisation Radio",
     "environment.action2.slogan": "L'équipe de l'ICPRD lors de l'identification des sites miniers exploités, détruits et abandonnés par les Ets Chinoise à Kitutu",
    "environment.action3.title": "Counseling aux Victimes",
    "environment.action3.desc":
      "Counseling au profit des victimes d'exploitation minière à Kitutu dans le Groupement de Banampute.",
    "environment.gallery": "Actions sur le Terrain",
    "environment.gallery.action1": "Identification des sites miniers exploités, détruits et abandonnés par les entreprises à Kitutu dans le territoire de Mwenga au Sud-Kivu.",
    "environment.gallery.action2": "Émissions radio GL Tv - Mwenga.",
    "environment.gallery.action3": "Counseling à Kitutu, Banampute.",

    // Achievements section
    "achievements.title": "Nos Réalisations",
    "achievements.subtitle":
      "Un aperçu de notre impact durable à travers le Sud-Kivu et le Nord-Kivu au fil des années.",

    "achievement1.title": "1,000+ Anciens Combattants Réintégrés",
    "achievement1.category": "Paix & Stabilité",
    "achievement1.status": "Projet en cours",
    "achievement1.desc":
      "Grâce à un accompagnement psychologique et une formation professionnelle, nous réintégrons avec succès d'anciens combattants, y compris d'anciens enfants soldats, dans leurs familles et communautés.",
    "achievement1.report": "Rapport Complet →",

    "achievement2.title": "Rapatriement Volontaire des Groupes Armés",
    "achievement2.category": "Désarmement",
    "achievement2.status": "2013-2014",
    "achievement2.desc":
      "L'ICPRD a été un facilitateur clé dans les opérations de sensibilisation et de désarmement volontaire de groupes armés, notamment les FDLR, contribuant directement à réduire les tensions et les violences.",
    "achievement2.report": "Rapport Complet →",

    "achievement3.title": "Centre de Réintégration de Kitamba",
    "achievement3.category": "Développement",
    "achievement3.status": "Lancé en 2023",
    "achievement3.desc":
      "Nous avons construit et équipé un centre de formation à Kitamba (Mwenga), offrant des compétences et un avenir aux démobilisés. 'Le PPR est un poumon du développement', témoigne le Mwami Kalenga Riziki Lwango.",
    "achievement3.report": "Rapport Complet →",

    // Team section
    "team.title": "Notre Équipe de Direction",
    "team.subtitle":
      "Guidée par des experts engagés, des activistes locaux et des artisans de paix dévoués.",
    "team.position1": "Conseillé au projet",
    "team.position2": "Secrétaire Exécutif",
    "team.position3": "Administrateur Financier ICPRD",
    "team.position4": "Coordinatrice Humanitaire",

    // CTA section
    "cta.title": "Soutenez la Paix Aujourd'hui",
    "cta.desc":
      "Votre contribution finance directement nos programmes de médiation communautaire, de désarmement volontaire et nos projets de développement dans les zones en proie aux conflits.",
    "cta.button1": "Faire un Don",
    "cta.button2": "Devenir Partenaire",

    // Blog section
    "blog.title": "Derniers Rapports & Témoignages",
    "blog.subtitle":
      "Analyses détaillées et récits issus de nos opérations sur le terrain à travers la RDC.",
    "blog.viewall": "Voir tous les articles",

    "blog1.category": "Paix",
    "blog1.title": "Éducation communautaire sur le BDH",
    "blog1.desc":
      "Retour sur nos missions de sensibilisation à Kigogo, Burhinyi et Minova qui ont conduit au rapatriement de centaines de combattants.",
    "blog1.author": "Équipe ICPRD",
    "blog1.date": "Il y a 2 jours",

    "blog2.category": "Formation",
    "blog2.title": "Kitamba : Un Centre pour l'Avenir",
    "blog2.desc":
      "Comment notre centre de réintégration socio-professionnelle forme d'anciens combattants à la menuiserie, la couture et d'autres métiers pour une réinsertion réussie.",
    "blog2.author": "Témoignage",
    "blog2.date": "Il y a 5 jours",

    "blog3.category": "Droits Humains",
    "blog3.title": "Formation des Défenseurs des Droits Humains",
    "blog3.desc":
      "Compte-rendu de notre atelier à Bukavu sur la collecte de données pour documenter les incidents dans la chaîne de valeur de l'exploitation minière.",
    "blog3.author": "Expert UN",
    "blog3.date": "Il y a 1 semaine",

    // Contact section
    "contact.title": "Construisons la Paix Ensemble",
    "contact.subtitle":
      "Que vous souhaitiez devenir partenaire, bénévole ou soutenir nos programmes, nous serions ravis d'échanger avec vous.",
    "contact.email": "Écrivez-nous",
    "contact.email_value": "contact@icprd.com",
    "contact.location": "Nos bureaux",
    "contact.location_value": "Av Vamaro, No 15, Com d'Ibanda Ville de Bukavu RDC",

    "form.name": "Nom",
    "form.name_placeholder": "Nom complet",
    "form.email": "Email",
    "form.email_placeholder": "Adresse email",
    "form.subject": "Sujet",
    "form.subject_placeholder": "Objet de votre message",
    "form.message": "Message",
    "form.message_placeholder": "Comment pouvons-nous vous aider ?",
    "form.button": "Envoyer le Message",

    // Footer
    "footer.desc":
      "Dédiée à favoriser l'harmonie et le développement durable à travers la République Démocratique du Congo depuis 2004.",
    "footer.org": "Organisation",
    "footer.org.about": "À propos",
    "footer.org.plan": "Plan Stratégique",
    "footer.org.reports": "Rapports Annuels",
    "footer.org.join": "Nous Rejoindre",

    "footer.legal": "Légal & Confidentialité",
    "footer.legal.privacy": "Politique de Confidentialité",
    "footer.legal.charter": "Charte des Donateurs",
    "footer.legal.governance": "Gouvernance",
    "footer.legal.transparency": "Transparence",

    "footer.newsletter": "Newsletter",
    "footer.newsletter.desc":
      "Recevez des mises à jour du terrain et nos rapports directement dans votre boîte mail.",
    "footer.newsletter.placeholder": "Adresse email",
    "footer.newsletter.button": "S'abonner",

    "footer.copyright":
      "© 2024 Initiative Chrétienne pour la Paix, la Réconciliation et le Développement.",
    "footer.tagline1": "La Paix est Possible",
    "footer.tagline2": "RDC Forte",
  },
};

// ============================================
// FONCTIONS DE TRADUCTION
// ============================================

let currentLang = "fr";

function applyTranslations() {
  console.log("Application des traductions pour:", currentLang);

  const langData = translations[currentLang];
  if (!langData) {
    console.error("Aucune traduction trouvée pour:", currentLang);
    return;
  }

  // Mettre à jour tous les éléments avec data-translate
  document.querySelectorAll("[data-translate]").forEach((element) => {
    const key = element.getAttribute("data-translate");
    if (langData[key]) {
      // Pour les éléments input et textarea
      if (element.tagName === "INPUT" || element.tagName === "TEXTAREA") {
        element.placeholder = langData[key];
      }
      // Pour les autres éléments
      else {
        element.textContent = langData[key];
      }
    } else if (key) {
      console.warn("Clé de traduction non trouvée:", key);
    }
  });

  // Mettre à jour l'attribut lang de la page
  document.documentElement.lang = currentLang;

  // Sauvegarder la préférence
  localStorage.setItem("icprd_lang", currentLang);

  // Mettre à jour l'interface des boutons de langue
  updateLanguageButtons();
}

function updateLanguageButtons() {
  document.querySelectorAll("[data-lang-btn]").forEach((button) => {
    const lang = button.getAttribute("data-lang-btn");
    if (lang === currentLang) {
      button.classList.remove(
        "text-slate-400",
        "hover:text-slate-600",
        "dark:hover:text-slate-200",
      );
      button.classList.add("text-primary");
    } else {
      button.classList.remove("text-primary");
      button.classList.add(
        "text-slate-400",
        "hover:text-slate-600",
        "dark:hover:text-slate-200",
      );
    }
  });
}

function switchLanguage(lang) {
  if (currentLang === lang) return;

  console.log("Changement de langue vers:", lang);
  currentLang = lang;
  applyTranslations();

  // Fermer le menu mobile si ouvert
  const mobileSidebar = document.getElementById("mobile-sidebar");
  if (mobileSidebar && !mobileSidebar.classList.contains("translate-x-full")) {
    closeSidebar();
  }
}

// ============================================
// GESTION DU MENU MOBILE
// ============================================

function initMobileMenu() {
  const sidebar = document.getElementById("mobile-sidebar");
  const overlay = document.getElementById("mobile-overlay");
  const toggleBtn = document.getElementById("mobile-menu-toggle");
  const closeBtn = document.getElementById("mobile-menu-close");

  if (!sidebar || !overlay || !toggleBtn || !closeBtn) {
    console.error("Éléments du menu mobile non trouvés");
    return;
  }

  // Ouvrir le sidebar
  toggleBtn.addEventListener("click", function () {
    sidebar.classList.remove("translate-x-full");
    overlay.classList.remove("hidden");
    document.body.style.overflow = "hidden";
  });

  // Fermer le sidebar
  function closeSidebar() {
    sidebar.classList.add("translate-x-full");
    overlay.classList.add("hidden");
    document.body.style.overflow = "";
  }

  // Fermer avec le bouton X
  closeBtn.addEventListener("click", closeSidebar);

  // Fermer en cliquant sur l'overlay
  overlay.addEventListener("click", closeSidebar);

  // Fermer en cliquant sur un lien dans le sidebar
  document.querySelectorAll(".sidebar-link").forEach((link) => {
    link.addEventListener("click", closeSidebar);
  });

  // Fermer avec la touche Escape
  document.addEventListener("keydown", function (event) {
    if (
      event.key === "Escape" &&
      !sidebar.classList.contains("translate-x-full")
    ) {
      closeSidebar();
    }
  });
}

// ============================================
// INITIALISATION
// ============================================

document.addEventListener("DOMContentLoaded", function () {
  console.log("ICPRD - Initialisation...");

  // Charger la langue sauvegardée
  const savedLang = localStorage.getItem("icprd_lang");
  if (savedLang && (savedLang === "en" || savedLang === "fr")) {
    currentLang = savedLang;
  }

  // Initialiser le menu mobile
  initMobileMenu();

  // Initialiser les boutons de langue
  document.querySelectorAll("[data-lang-btn]").forEach((button) => {
    button.addEventListener("click", function () {
      const lang = this.getAttribute("data-lang-btn");
      switchLanguage(lang);
    });
  });

  // Appliquer les traductions initiales
  applyTranslations();

  console.log("ICPRD - Prêt! Langue:", currentLang);
});

// ============================================
// ANIMATIONS GSAP POUR ICPRD
// ============================================

class ICPRDAnimations {
  constructor() {
    this.init();
  }

  init() {
    // Attendre que la page soit chargée
    window.addEventListener("load", () => {
      this.animateHero();
      this.animateStats();
      this.animatePillars();
      this.animateAchievements();
      this.animateEnvironment();
      this.animateTeam();
      this.animateBlog();
      this.animateContact();
      this.animateHeader();
      this.initScrollAnimations();
      this.initHoverEffects();
    });
  }

  // 1. ANIMATION HERO SECTION (Entrée spectaculaire)
  animateHero() {
    const heroTimeline = gsap.timeline({ defaults: { ease: "power3.out" } });

    heroTimeline
      .fromTo(".hero-gradient", { opacity: 0 }, { opacity: 1, duration: 1.5 })
      .from(
        '[data-translate="hero.badge"]',
        {
          y: 50,
          opacity: 0,
          scale: 0.8,
          duration: 0.8,
        },
        "-=0.5",
      )
      .from(
        '[data-translate="hero.title"]',
        {
          y: 80,
          opacity: 0,
          duration: 1,
          stagger: 0.2,
        },
        "-=0.3",
      )
      .from(
        '[data-translate="hero.subtitle"]',
        {
          y: 40,
          opacity: 0,
          duration: 0.8,
        },
        "-=0.2",
      );
    // .from('[data-translate="hero.button1"]', {
    //   x: -50,
    //   opacity: 0,
    //   duration: 0.6
    // }, '-=0.2')
    // .from('[data-translate="hero.button2"]', {
    //   x: 50,
    //   opacity: 0,
    //   duration: 0.6
    // }, '-=0.6');
  }

  // 2. ANIMATION DES STATISTIQUES (Compteurs)
  animateStats() {
    // Animation des containers de stats
    gsap.from(".grid.grid-cols-2 > div", {
      scrollTrigger: {
        trigger: ".py-12.bg-white",
        start: "top 80%",
        toggleActions: "play none none reverse",
      },
      y: 60,
      opacity: 0,
      duration: 1,
      stagger: 0.2,
      ease: "back.out(1.7)",
    });

    // Animation des compteurs - VERSION CORRIGÉE
    const counters = document.querySelectorAll(
      ".grid.grid-cols-2 .text-4xl.font-black",
    );
    counters.forEach((counter) => {
      // Extraire seulement le nombre (ex: "20k+" -> 20)
      const text = counter.textContent.trim();
      const match = text.match(/(\d+)/); // Cherche uniquement les chiffres
      const target = match ? parseInt(match[1]) : 0;

      // Sauvegarder le format original (ex: "k+", "+", etc.)
      const suffix = text.replace(/\d+/g, ""); // Garde tout sauf les chiffres

      const obj = { value: 0 };

      gsap.to(obj, {
        value: target,
        duration: 2,
        scrollTrigger: {
          trigger: counter.closest(".grid.grid-cols-2"),
          start: "top 90%",
          toggleActions: "play none none reverse",
        },
        onUpdate: () => {
          counter.textContent = Math.floor(obj.value) + suffix;
        },
        onComplete: () => {
          // Assure que la valeur finale est exacte
          counter.textContent = target + suffix;
        },
        ease: "power2.out",
      });
    });
  }
  // 3. ANIMATION DES PILLIERS (Cartes avec effet cascade)
  animatePillars() {
    const cards = gsap.utils.toArray(".group.bg-white");

    cards.forEach((card, i) => {
      gsap.from(card, {
        scrollTrigger: {
          trigger: card,
          start: "top 85%",
          toggleActions: "play none none reverse",
        },
        y: 100,
        opacity: 0,
        rotationY: i % 2 === 0 ? -15 : 15,
        duration: 1,
        delay: i * 0.2,
        ease: "power3.out",
      });

      // Animation au survol
      card.addEventListener("mouseenter", () => {
        gsap.to(card, {
          y: -10,
          duration: 0.4,
          ease: "power2.out",
        });
      });

      card.addEventListener("mouseleave", () => {
        gsap.to(card, {
          y: 0,
          duration: 0.4,
          ease: "power2.out",
        });
      });
    });
  }

  // 4. ANIMATION DES RÉALISATIONS (Effet parallaxe)
  animateAchievements() {
    const achievements = gsap.utils.toArray(".group.relative.flex-col");

    achievements.forEach((achievement, i) => {
      // Animation d'entrée
      gsap.from(achievement, {
        scrollTrigger: {
          trigger: achievement,
          start: "top 85%",
          toggleActions: "play none none reverse",
        },
        y: 80,
        opacity: 0,
        scale: 0.9,
        duration: 1,
        delay: i * 0.15,
        ease: "back.out(1.7)",
      });

      // Effet parallaxe sur les images
      const img = achievement.querySelector("img");
      gsap.to(img, {
        y: -30,
        ease: "none",
        scrollTrigger: {
          trigger: achievement,
          start: "top bottom",
          end: "bottom top",
          scrub: true,
        },
      });
    });
  }

  animateEnvironment() {
    gsap.from("#environment", {
      scrollTrigger: {
        trigger: "#environment",
        start: "top 80%",
        toggleActions: "play none none reverse",
      },
      opacity: 0,
      y: 50,
      duration: 1,
      ease: "power3.out",
    });

    gsap.utils.toArray("#environment .flex.gap-4").forEach((item, i) => {
      gsap.from(item, {
        scrollTrigger: {
          trigger: item,
          start: "top 85%",
          toggleActions: "play none none reverse",
        },
        x: -50,
        opacity: 0,
        duration: 0.8,
        delay: i * 0.2,
        ease: "back.out(1.2)",
      });
    });

    gsap.utils.toArray("#environment .grid-cols-3 > div").forEach((card, i) => {
      gsap.from(card, {
        scrollTrigger: {
          trigger: card,
          start: "top 85%",
          toggleActions: "play none none reverse",
        },
        scale: 0.8,
        opacity: 0,
        duration: 0.8,
        delay: i * 0.1,
        ease: "back.out(1.7)",
      });
    });
  }

  // 5. ANIMATION DE L'ÉQUIPE (Rotation 3D)
  animateTeam() {
    const teamMembers = gsap.utils.toArray(".flex.flex-col.items-center.group");

    teamMembers.forEach((member, i) => {
      gsap.from(member, {
        scrollTrigger: {
          trigger: member,
          start: "top 90%",
          toggleActions: "play none none reverse",
        },
        y: 60,
        opacity: 0,
        rotationY: 20,
        duration: 1,
        delay: i * 0.1,
        ease: "power3.out",
      });

      // Animation au survol des photos
      const img = member.querySelector("img");
      member.addEventListener("mouseenter", () => {
        gsap.to(img, {
          scale: 1.05,
          filter: "grayscale(0)",
          duration: 0.5,
          ease: "power2.out",
        });
        gsap.to(member.querySelector(".absolute.inset-0"), {
          rotation: 12,
          duration: 0.5,
          ease: "power2.out",
        });
      });

      member.addEventListener("mouseleave", () => {
        gsap.to(img, {
          scale: 1,
          filter: "grayscale(1)",
          duration: 0.5,
          ease: "power2.out",
        });
        gsap.to(member.querySelector(".absolute.inset-0"), {
          rotation: 6,
          duration: 0.5,
          ease: "power2.out",
        });
      });
    });
  }

  // 6. ANIMATION DES ARTICLES DE BLOG
  animateBlog() {
    const blogCards = gsap.utils.toArray(".flex.flex-col.bg-white");

    blogCards.forEach((card, i) => {
      gsap.from(card, {
        scrollTrigger: {
          trigger: card,
          start: "top 85%",
          toggleActions: "play none none reverse",
        },
        y: 50,
        opacity: 0,
        rotationX: 10,
        duration: 0.8,
        delay: i * 0.1,
        ease: "power2.out",
      });

      // Animation hover avec effet de profondeur
      card.addEventListener("mouseenter", () => {
        gsap.to(card, {
          y: -15,
          rotationX: 5,
          duration: 0.3,
          ease: "power2.out",
        });
      });

      card.addEventListener("mouseleave", () => {
        gsap.to(card, {
          y: 0,
          rotationX: 0,
          duration: 0.3,
          ease: "power2.out",
        });
      });
    });
  }

  // 7. ANIMATION SECTION CONTACT (Formulaire)
  animateContact() {
    gsap.from(".text-white > h2", {
      scrollTrigger: {
        trigger: "#contact",
        start: "top 80%",
        toggleActions: "play none none reverse",
      },
      y: 50,
      opacity: 0,
      duration: 1,
      ease: "power3.out",
    });

    // Animation des inputs
    const inputs = gsap.utils.toArray(".form-input, input, textarea, button");
    inputs.forEach((input, i) => {
      gsap.from(input, {
        scrollTrigger: {
          trigger: input,
          start: "top 90%",
          toggleActions: "play none none reverse",
        },
        y: 30,
        opacity: 0,
        duration: 0.6,
        delay: i * 0.05,
        ease: "power2.out",
      });
    });
  }

  // 8. ANIMATION DU HEADER (Apparition)
  animateHeader() {
    gsap.from("header", {
      y: -100,
      opacity: 0,
      duration: 0.8,
      ease: "power3.out",
    });

    // Animation des liens de navigation
    const navLinks = gsap.utils.toArray("nav a");
    navLinks.forEach((link, i) => {
      gsap.from(link, {
        y: -20,
        opacity: 0,
        duration: 0.5,
        delay: i * 0.1,
        ease: "power2.out",
      });
    });
  }

  // 9. ANIMATIONS AU SCROLL (Smooth scrolling)
  initScrollAnimations() {
    // Smooth scroll pour les ancres
    document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
      anchor.addEventListener("click", function (e) {
        e.preventDefault();
        const targetId = this.getAttribute("href");
        if (targetId === "#") return;

        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          gsap.to(window, {
            duration: 1,
            scrollTo: {
              y: targetElement,
              offsetY: 80,
            },
            ease: "power3.inOut",
          });
        }
      });
    });

    // Animation de la sidebar mobile
    const sidebar = document.getElementById("mobile-sidebar");
    const overlay = document.getElementById("mobile-overlay");
    const toggleBtn = document.getElementById("mobile-menu-toggle");
    const closeBtn = document.getElementById("mobile-menu-close");

    if (toggleBtn && sidebar) {
      toggleBtn.addEventListener("click", () => {
        gsap.to(sidebar, {
          x: 0,
          duration: 0.4,
          ease: "power3.out",
        });
        gsap.to(overlay, {
          opacity: 1,
          duration: 0.3,
          display: "block",
        });
      });

      closeBtn.addEventListener("click", () => {
        this.closeMobileMenu();
      });

      overlay.addEventListener("click", () => {
        this.closeMobileMenu();
      });
    }
  }

  closeMobileMenu() {
    const sidebar = document.getElementById("mobile-sidebar");
    const overlay = document.getElementById("mobile-overlay");

    gsap.to(sidebar, {
      x: "100%",
      duration: 0.4,
      ease: "power3.in",
    });
    gsap.to(overlay, {
      opacity: 0,
      duration: 0.3,
      display: "none",
    });
  }

  // 10. EFFETS DE SURVOL AVANCÉS
  initHoverEffects() {
    // Boutons avec effet de vague
    const buttons = document.querySelectorAll("button.bg-primary");
    buttons.forEach((button) => {
      button.addEventListener("mouseenter", (e) => {
        const rect = button.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        gsap.to(button, {
          "--x": x,
          "--y": y,
          duration: 0.3,
          ease: "power2.out",
        });
      });
    });

    // Effet de parallaxe sur les images de background
    const bgImages = document.querySelectorAll(".absolute.inset-0.bg-cover");
    bgImages.forEach((bg) => {
      gsap.to(bg, {
        yPercent: 10,
        ease: "none",
        scrollTrigger: {
          trigger: bg.parentElement,
          start: "top bottom",
          end: "bottom top",
          scrub: true,
        },
      });
    });
  }
}

// Initialisation
document.addEventListener("DOMContentLoaded", () => {
  const animations = new ICPRDAnimations();

  // Exposer globalement pour le débogage
  window.ICPRDAnimations = animations;
});
